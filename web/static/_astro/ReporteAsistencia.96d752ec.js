import{g,i as _,c as l,F as $,a as E,b as w,t as u,d as D,e as j,f as A,h as N,M as x,S as C}from"./web.92a94299.js";const I=u('<table><thead class="bg-white border-b"><tr></tr></thead><tbody>'),T=u('<th scope="col" class="text-sm font-medium text-gray-900 px-6 text-center">'),M=u("<div>No data"),k=u("<tr>"),L=u("<td>");function F(e){const a=()=>Object.keys(e.data[0]);return(()=>{const t=g(I),r=t.firstChild,s=r.firstChild,n=r.nextSibling;return _(s,l($,{get each(){return e.titles},children:c=>(()=>{const f=g(T);return _(f,c),f})()})),_(n,l($,{get each(){return e.data},get fallback(){return g(M)},children:(c,f)=>(()=>{const o=g(k);return _(o,l($,{get each(){return a()},children:(i,y)=>(()=>{const h=g(L);return _(h,(()=>{const b=E(()=>!!(e.col_conditions&&e.col_conditions[i]));return()=>b()?e.col_conditions[i](i,c[i]):c[i]})()),w(()=>D(h,`border-2 border-black whitespace-nowrap text-sm font-medium text-center text-gray-900 ${y()===0?"font-medium":"font-light"}`)),h})()})),w(()=>D(o,`${f()%2?"bg-white":"bg-gray-100"} border-b`)),o})()})),t})()}function R(e){const a=Object.keys(e),t=Object.keys(e[a[0]]).length;let r=Array.from({length:t},()=>({}));for(let s=0;s<t;s++)for(let n=0;n<a.length;n++)r[s][a[n]]=Object.values(e[a[n]])[s];return r}const V=u("<span>"),G=u('<h3 class="text-xl font-bold">Trabajador'),m=new Date,p=m.getDay(),O=new Date;O.setDate(p<4?m.getDate()-p-3:m.getDate()-p+4);const J=U(O,m),S={A:"bg-green-50 text-green-600",B:"bg-gray-50 text-gray-600",P:"bg-green-50 text-green-600",F:"bg-red-50 text-red-600",V:"bg-gray-50 text-gray-600",N:"bg-gray-50 text-gray-600",I:"bg-yellow-50 text-yellow-600"};function U(e,a){let t=[];for(let r=e;r<=a;r.setDate(r.getDate()+1)){const s=r.toUTCString().split(" ");t.push(`${s[1]} ${s[2]}`)}return t}function P(e,a,t){const r=new Array(t.length),s={0:"J",1:"V",2:"S",3:"D",4:"L",5:"M",6:"m"};for(let n=0;n<t.length;n++){r[n]={nombres:`${t[n].Nombres} ${t[n].APaterno}`.toUpperCase()};for(let c=0;c<e.length;c++)r[n][s[c]]="A"}for(let n=0;n<a.length;n++){const c=a[n],o=new Date(c.Fecha).toUTCString().split(" "),i=`${o[1]} ${o[2]}`,y=e.indexOf(i);let h,b=0;for(;b<t.length;){if(t[b].idTrabajador===c.idTrabajador){h=b;break}b++}r[h][s[y]]=c.idIncidencia}return r}function Y(e,a){const t=R(e),r=R(a);return P(J,r,t)}function d(e,a){return e==="nombres"||!S[a]?a:(()=>{const t=g(V);return _(t,a),w(()=>D(t,`inline-flex w-full h-full font-bold justify-center items-center text-lg ${S[a]}`)),t})()}const v={J:d,V:d,S:d,D:d,L:d,M:d,m:d};async function B(){return await(await fetch("http://192.168.100.10:5000/api/trabajadores")).json()}async function q(){return await(await fetch("http://192.168.100.10:5000/api/trabajadores/asistencias")).json()}function H(){const[e,a]=j(null),[t,r]=j({state:"LOADING"}),[s]=A(B),[n]=A(q);let c=[g(G)];return c=[c,...Object.values({0:"Jueves",1:"Viernes",2:"Sábado",3:"Domingo",4:"Lunes",5:"Martes",6:"Miércoles"})],N(async()=>{if(s.state==="ready"&&n.state==="ready"){r({state:"READY",msg:""});const o=Y(s.latest,n.latest);a(o)}else s.error||n.error?r({state:"ERROR",msg:"Error de peticion de tablas"}):(s.loading||n.loading)&&r({state:"LOADING",msg:"Cargando informacion..."})}),l(C,{get children(){return[l(x,{get when(){return t().state==="ERROR"},get children(){return t().msg}}),l(x,{get when(){return t().state==="LOADING"},get children(){return t().msg}}),l(x,{get when(){return E(()=>t().state==="READY")()&&e()!==null},get children(){return l(F,{get data(){return e()},titles:c,col_conditions:v})}})]}})}export{H as default};
