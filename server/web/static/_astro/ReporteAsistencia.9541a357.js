import{g as f,i as o,c as u,F as m,a as E,b as I,t as h,d as S,e as C,f as N,h as Y,M as x,j as p,S as G}from"./web.496f7d18.js";const z=h('<table><thead class="bg-white border-b"><tr></tr></thead><tbody>'),q=h('<th scope="col" class="text-sm font-medium text-gray-900 px-6 text-center">'),H=h("<div>No data"),K=h("<tr>"),Q=h("<td>");function W(e){const r=()=>Object.keys(e.data[0]);return(()=>{const t=f(z),l=t.firstChild,a=l.firstChild,n=l.nextSibling;return o(a,u(m,{get each(){return e.titles},children:s=>(()=>{const $=f(q);return o($,s),$})()})),o(n,u(m,{get each(){return e.data},get fallback(){return f(H)},children:(s,$)=>(()=>{const i=f(K);return o(i,u(m,{get each(){return r()},children:(d,A)=>(()=>{const c=f(Q);return o(c,(()=>{const g=E(()=>!!(e.col_conditions&&e.col_conditions[d]));return()=>g()?e.col_conditions[d](d,s[d]):s[d]})()),I(()=>S(c,`border-2 border-black whitespace-nowrap text-sm font-medium text-gray-900 ${A()===0?"font-medium text-left":"font-light text-center"}`)),c})()})),I(()=>S(i,`${$()%2?"bg-white":"bg-gray-100"} border-b`)),i})()})),t})()}function T(e){const r=Object.keys(e),t=Object.keys(e[r[0]]).length;let l=Array.from({length:t},()=>({}));for(let a=0;a<t;a++)for(let n=0;n<r.length;n++)l[a][r[n]]=Object.values(e[r[n]])[a];return l}const X=h("<span>"),Z=h('<h3 class="text-xl font-bold">Trabajador'),tt=h('<div class="w-full h-screen flex flex-col items-center gap-5"><h1 class="uppercase tracking-wide font-bold underline">José Salcedo Nuñez</h1><div class="flex justify-around uppercase w-full max-w-7xl"><h2>Nómina periodo <!#><!/></h2><h2 class="font-bold underline"></h2></div><!#><!/><div class="text-xs"><h3 class="font-bold uppercase">Trabajadores: <!#><!/></h3><h3 class="font-bold uppercase underline">Clave</h3><ul class="ml-5"><li>A = ASISTENCIA</li><li>B = BAJA</li><li>P = PERMISO (FALTA INJUSTIFICADA, NO AMERITA ACTA ADMINISTRATIVA)</li><li>F = FALTA INJUSTIFICADA (AMERITA ACTA ADMINISTRATIVA)</li><li>V = VACACIONES</li><li>N = NO LABORABLE</li><li>I = INCAPACIDAD</li></ul></div><div class="w-full flex flex-col items-center mt-20"><div class="w-1/4 h-[4px] bg-black"></div><p>JEFE DE PRODUCCIÓN'),_=new Date,et=new Date(_.getFullYear(),0,1),nt=Math.ceil(Math.floor((_-et)/(24*60*60*1e3))/7),y=_.getDay(),O=new Date;O.setDate(y<4?_.getDate()-y-3:_.getDate()-y+4);const lt=rt(O,_),R={A:"bg-green-50 text-green-600",B:"bg-gray-50 text-gray-600",P:"bg-green-50 text-green-600",F:"bg-red-50 text-red-600",V:"bg-gray-50 text-gray-600",N:"bg-gray-50 text-gray-600",I:"bg-yellow-50 text-yellow-600"};function rt(e,r){let t=[];for(let l=e;l<=r;l.setDate(l.getDate()+1)){const a=l.toUTCString().split(" ");t.push(`${a[1]} ${a[2]}`)}return t}function at(e,r,t){const l=new Array(t.length),a={0:"J",1:"V",2:"S",3:"D",4:"L",5:"M",6:"m"};for(let n=0;n<t.length;n++){l[n]={nombres:`${t[n].Nombres} ${t[n].APaterno}`.toUpperCase()};for(let s=0;s<e.length;s++)l[n][a[s]]="A"}for(let n=0;n<r.length;n++){const s=r[n],i=new Date(s.Fecha).toUTCString().split(" "),d=`${i[1]} ${i[2]}`,A=e.indexOf(d);let c,g=0;for(;g<t.length;){if(t[g].idTrabajador===s.idTrabajador){c=g;break}g++}l[c][a[A]]=s.idIncidencia}return l}function st(e,r){const t=T(e),l=T(r);return at(lt,l,t)}function b(e,r){return e==="nombres"||!R[r]?r:(()=>{const t=f(X);return o(t,r),I(()=>S(t,`inline-flex w-full h-full font-bold justify-center items-center text-lg ${R[r]}`)),t})()}const it={J:b,V:b,S:b,D:b,L:b,M:b,m:b};async function ct(){return await(await fetch("http://192.168.100.7:5000/api/trabajadores")).json()}async function ot(){return await(await fetch("http://192.168.100.7:5000/api/trabajadores/asistencias")).json()}function gt(){const[e,r]=C(null),[t,l]=C({state:"LOADING"}),[a]=N(ct),[n]=N(ot);let s=[f(Z)];return s=[s,...Object.values({0:"J",1:"V",2:"S",3:"D",4:"L",5:"M",6:"m"})],Y(async()=>{if(a.state==="ready"&&n.state==="ready"){l({state:"READY",msg:""});const i=st(a.latest,n.latest);r(i)}else a.error||n.error?l({state:"ERROR",msg:"Error de peticion de tablas"}):(a.loading||n.loading)&&l({state:"LOADING",msg:"Cargando informacion..."})}),u(G,{get children(){return[u(x,{get when(){return t().state==="ERROR"},get children(){return t().msg}}),u(x,{get when(){return t().state==="LOADING"},get children(){return t().msg}}),u(x,{get when(){return E(()=>t().state==="READY"&&e()!==null)()&&typeof e()?.length<"u"},get children(){const i=f(tt),d=i.firstChild,A=d.nextSibling,c=A.firstChild,g=c.firstChild,j=g.nextSibling,[M,F]=p(j.nextSibling),k=c.nextSibling,L=A.nextSibling,[w,v]=p(L.nextSibling),J=w.nextSibling,D=J.firstChild,V=D.firstChild,P=V.nextSibling,[U,B]=p(P.nextSibling);return o(c,nt,M,F),o(k,()=>_.getFullYear()),o(i,u(W,{get data(){return e()},titles:s,col_conditions:it}),w,v),o(D,()=>e().length,U,B),i}})]}})}export{gt as default};
