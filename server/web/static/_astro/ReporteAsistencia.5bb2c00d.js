import{g as f,i as o,c as u,F as A,a as E,b as I,t as h,d as y,e as C,f as N,h as Y,M as x,j as p,S as G}from"./web.496f7d18.js";const z=h('<table><thead class="bg-white border-b"><tr></tr></thead><tbody>'),q=h('<th scope="col" class="text-sm font-medium text-gray-900 px-6 text-center">'),H=h("<div>No data"),K=h("<tr>"),Q=h("<td>");function W(t){const a=()=>Object.keys(t.data[0]);return(()=>{const n=f(z),l=n.firstChild,e=l.firstChild,s=l.nextSibling;return o(e,u(A,{get each(){return t.titles},children:i=>(()=>{const m=f(q);return o(m,i),m})()})),o(s,u(A,{get each(){return t.data},get fallback(){return f(H)},children:(i,m)=>(()=>{const r=f(K);return o(r,u(A,{get each(){return a()},children:(d,$)=>(()=>{const c=f(Q);return o(c,(()=>{const g=E(()=>!!(t.col_conditions&&t.col_conditions[d]));return()=>g()?t.col_conditions[d](d,i[d]):i[d]})()),I(()=>y(c,`border-2 border-black whitespace-nowrap text-sm font-medium text-gray-900 ${$()===0?"font-medium text-left":"font-light text-center"}`)),c})()})),I(()=>y(r,`${m()%2?"bg-white":"bg-gray-100"} border-b`)),r})()})),n})()}function T(t){const a=Object.keys(t),n=Object.keys(t[a[0]]).length;let l=Array.from({length:n},()=>({}));for(let e=0;e<n;e++)for(let s=0;s<a.length;s++)l[e][a[s]]=Object.values(t[a[s]])[e];return l}function X(t,a,n){let l=!0;do{l=!1;for(let e=0;e<t.length-1;e++)if(n){if(t[e][a]>t[e+1][a]){let s=t[e];t[e]=t[e+1],t[e+1]=s,l=!0}}else if(t[e][a]<t[e+1][a]){let s=t[e];t[e]=t[e+1],t[e+1]=s,l=!0}}while(l);return t}const Z=h("<span>"),tt=h('<h3 class="text-xl font-bold">Trabajador'),et=h('<div class="w-full h-screen flex flex-col items-center gap-5"><h1 class="uppercase tracking-wide font-bold underline">José Salcedo Nuñez</h1><div class="flex justify-around uppercase w-full max-w-7xl"><h2>Nómina periodo <!#><!/></h2><h2 class="font-bold underline"></h2></div><!#><!/><div class="text-xs"><h3 class="font-bold uppercase">Trabajadores: <!#><!/></h3><h3 class="font-bold uppercase underline">Clave</h3><ul class="ml-5"><li>A = ASISTENCIA</li><li>B = BAJA</li><li>P = PERMISO (FALTA INJUSTIFICADA, NO AMERITA ACTA ADMINISTRATIVA)</li><li>F = FALTA INJUSTIFICADA (AMERITA ACTA ADMINISTRATIVA)</li><li>V = VACACIONES</li><li>N = NO LABORABLE</li><li>I = INCAPACIDAD</li></ul></div><div class="w-full flex flex-col items-center mt-20"><div class="w-1/4 h-[4px] bg-black"></div><p>JEFE DE PRODUCCIÓN'),b=new Date,nt=new Date(b.getFullYear(),0,1),lt=Math.ceil(Math.floor((b-nt)/(24*60*60*1e3))/7),w=b.getDay(),j=new Date;j.setDate(w<4?b.getDate()-w-3:b.getDate()-w+4);const st=at(j,b),R={A:"bg-green-50 text-green-600",B:"bg-gray-50 text-gray-600",P:"bg-green-50 text-green-600",F:"bg-red-50 text-red-600",V:"bg-gray-50 text-gray-600",N:"bg-gray-50 text-gray-600",I:"bg-yellow-50 text-yellow-600"};function at(t,a){let n=[];for(let l=t;l<=a;l.setDate(l.getDate()+1)){const e=l.toUTCString().split(" ");n.push(`${e[1]} ${e[2]}`)}return n}function it(t,a,n){const l=new Array(n.length),e={0:"J",1:"V",2:"S",3:"D",4:"L",5:"M",6:"m"};for(let s=0;s<n.length;s++){l[s]={nombres:`${n[s].Nombres} ${n[s].APaterno}`.toUpperCase()};for(let i=0;i<t.length;i++)l[s][e[i]]="A"}for(let s=0;s<a.length;s++){const i=a[s],r=new Date(i.Fecha).toUTCString().split(" "),d=`${r[1]} ${r[2]}`,$=t.indexOf(d);let c,g=0;for(;g<n.length;){if(n[g].idTrabajador===i.idTrabajador){c=g;break}g++}l[c][e[$]]=i.idIncidencia}return l}function rt(t,a){const n=T(t),l=T(a);return X(n,"idNivel",!1),it(st,l,n)}function _(t,a){return t==="nombres"||!R[a]?a:(()=>{const n=f(Z);return o(n,a),I(()=>y(n,`inline-flex w-full h-full font-bold justify-center items-center text-lg ${R[a]}`)),n})()}const ct={J:_,V:_,S:_,D:_,L:_,M:_,m:_};async function ot(){return await(await fetch("http://192.168.100.7:5000/api/trabajadores")).json()}async function dt(){return await(await fetch("http://192.168.100.7:5000/api/trabajadores/asistencias")).json()}function ft(){const[t,a]=C(null),[n,l]=C({state:"LOADING"}),[e]=N(ot),[s]=N(dt);let i=[f(tt)];return i=[i,...Object.values({0:"J",1:"V",2:"S",3:"D",4:"L",5:"M",6:"m"})],Y(async()=>{if(e.state==="ready"&&s.state==="ready"){l({state:"READY",msg:""});const r=rt(e.latest,s.latest);a(r)}else e.error||s.error?l({state:"ERROR",msg:"Error de peticion de tablas"}):(e.loading||s.loading)&&l({state:"LOADING",msg:"Cargando informacion..."})}),u(G,{get children(){return[u(x,{get when(){return n().state==="ERROR"},get children(){return n().msg}}),u(x,{get when(){return n().state==="LOADING"},get children(){return n().msg}}),u(x,{get when(){return E(()=>n().state==="READY"&&t()!==null)()&&typeof t()?.length<"u"},get children(){const r=f(et),d=r.firstChild,$=d.nextSibling,c=$.firstChild,g=c.firstChild,O=g.nextSibling,[M,F]=p(O.nextSibling),v=c.nextSibling,L=$.nextSibling,[S,J]=p(L.nextSibling),V=S.nextSibling,D=V.firstChild,k=D.firstChild,P=k.nextSibling,[U,B]=p(P.nextSibling);return o(c,lt,M,F),o(v,()=>b.getFullYear()),o(r,u(W,{get data(){return t()},titles:i,col_conditions:ct}),S,J),o(D,()=>t().length,U,B),r}})]}})}export{ft as default};
